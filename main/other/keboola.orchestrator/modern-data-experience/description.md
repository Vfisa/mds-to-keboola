This is the whole pipeline
